# compatibility for express.js
NODE_ENV=production
# MAIN CONFIG

PORT=3000
DB_PATH=./database.db
DATA_FOLDER_PATH=./data # where level data is stored
CREATE_DATA_FOLDER=true # create the data folder if it doesn't exist
USE_PUBLIC_FOLDER=true # use public folder for static files
PUBLIC_FOLDER_PATH=./public # where static files are stored
USE_TEST_UI=true # enable access to test interface (/index.html)
USE_ADMIN_UI=true # enable access to admin interface (/admin.html)
GAME_URL=https://pvzm.net # url to the pvzm game, used in share links
GAME_URL_SECRET=abcdefghijklmnopqrstuvwxyz0123456789 # secret appended to game URL requests to bypass WAF/bot protection. generate with openssl rand --hex 32
BACKEND_URL=https://backend.pvzm.net # url to this backend, used in links for admins

# CORS CONFIGURATION
CORS_ENABLED=true
# comma-separated list of allowed domains (no spaces)
ALLOWED_ORIGINS=https://pvzm.net,https://backend.pvzm.net

# OPTIONAL SERVICES

# use cloudflare turnstile for captcha
USE_TURNSTILE=true
# sign up for turnstile @ https://www.cloudflare.com/application-services/products/turnstile/
TURNSTILE_SECRET=some-turnstile-secret
TURNSTILE_SITE_KEY=some-turnstile-site-key
# accepts dummy tokens, DO NOT TURN ON IN PRODUCTION
TURNSTILE_TESTING=false

# use openai moderation to filter out bad content
USE_OPENAI_MODERATION=true
# youll need to top up your account with $5, but the endpoint is free to use
# get your API key from https://platform.openai.com/account/api-keys
OPENAI_API_KEY=some-openai-api-key

# upload logging - posts to external services when levels are uploaded/updated/deleted
# supports multiple providers (discord, bluesky, etc.) via the logging module
USE_UPLOAD_LOGGING=true

# discord logging provider (supports all events)
# create a bot at https://discord.com/developers/applications
# bot needs "Send Messages" and "Manage Messages" permissions in the upload channel
DISCORD_PROVIDER_ENABLED=true
DISCORD_BOT_TOKEN=some-discord-bot-token
DISCORD_UPLOAD_CHANNEL_ID=some-discord-upload-channel-id
# optional: separate channel for admin notifications (with edit/delete buttons)
DISCORD_ADMIN_UPLOAD_CHANNEL_ID=some-discord-admin-upload-channel-id

# reporting - posts to discord when levels are reported
USE_REPORTING=true
DISCORD_REPORT_CHANNEL_ID=some-discord-report-channel-id
# user ids to mention in reports (prefix with & for a role id)
DISCORD_MENTION_USER_IDS=some-discord-user-id,&some-discord-role-id

# audit log - posts to discord when admins make changes (edit/delete/feature)
DISCORD_AUDIT_CHANNEL_ID=some-discord-audit-channel-id

# bluesky logging provider (supports upload events)
BLUESKY_PROVIDER_ENABLED=false
BLUESKY_IDENTIFIER=some-bluesky-identifier.example.com
BLUESKY_PASSWORD=some-bluesky-password
BLUESKY_PDS=https://pds.example.com

# authentication (better-auth)
# generate with: openssl rand -base64 32
AUTH_SECRET=some-auth-secret
# comma-separated list of better-auth user IDs that bypass role checks and always have admin access
# useful for bootstrapping - these users can perform admin operations regardless of their role in the DB
# ref: https://www.better-auth.com/docs/plugins/admin#admin-user-ids
AUTH_ADMIN_USER_IDS=
# optional: github oauth (sign in with github)
USE_GITHUB_AUTH=false
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# posthog analytics
USE_POSTHOG_ANALYTICS=false
POSTHOG_API_KEY=phc_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
POSTHOG_HOST=https://us.i.posthog.com

# opentelemetry (best for posthog logs)
OTEL_DENO=true
OTEL_EXPORTER_OTLP_LOGS_ENDPOINT=https://us.i.posthog.com/i/v1/logs
OTEL_EXPORTER_OTLP_LOGS_HEADERS=Authorization=Bearer phc_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
OTEL_SERVICE_NAME=pvzm-backend
